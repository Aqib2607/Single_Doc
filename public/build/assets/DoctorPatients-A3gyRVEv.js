import{r as o,j as e,B as j}from"./app-CZEgLpFD.js";import{H as g}from"./Helmet-DN3Zoftl.js";import{C as N,b,c as y,d as v,a as w}from"./card-DFx5BNHy.js";import{N as D,F as E}from"./Footer-Bjw2Y91L.js";import{D as k}from"./DoctorSidebar-j5VNeU9f.js";import{U as C}from"./users-DUM4TGor.js";import{T as P}from"./trash-2-tOVpyRHD.js";import"./index-Bvg-n_-7.js";import"./Combination-DEIAJigP.js";import"./clock-DFpeTyfe.js";import"./stethoscope-CVh3js6S.js";import"./file-text-SYWGHUBY.js";import"./message-square-27UvQ_K7.js";import"./pill-CGZaujNT.js";const V=()=>{const[i,p]=o.useState([]),[l,d]=o.useState(!1),[c,r]=o.useState(""),[m,x]=o.useState(null);o.useEffect(()=>{h()},[]);const h=async()=>{d(!0),r("");try{const t=localStorage.getItem("token"),s=await fetch("/api/patients",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(s.ok){const a=await s.json();console.log("Patients data:",a),p(a)}else r("Failed to load patients")}catch(t){console.error("Error fetching patients:",t),r("Network error occurred")}finally{d(!1)}},f=async(t,s)=>{if(console.log("Delete patient ID:",t,"Name:",s),!t||t===void 0||t===null){console.error("Invalid patient ID:",t),r(`Invalid patient ID: ${t}`);return}if(confirm(`Are you sure you want to delete patient "${s}"? This action cannot be undone.`)){x(t),r("");try{const a=localStorage.getItem("token");console.log("Deleting patient with URL:",`/api/patients/${t}`);const n=await fetch(`/api/patients/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(console.log("Delete response status:",n.status),n.ok)await h();else{const u=await n.json().catch(()=>({message:"Failed to delete patient"}));console.error("Delete error:",u),r(u.message||"Failed to delete patient. Please try again.")}}catch(a){console.error("Error deleting patient:",a),r("Network error occurred while deleting patient")}finally{x(null)}}};return e.jsxs(e.Fragment,{children:[e.jsx(g,{children:e.jsx("title",{children:"Patients - Doctor Dashboard"})}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(D,{}),e.jsxs("div",{className:"flex pt-20",children:[e.jsx(k,{}),e.jsx("main",{className:"flex-1 px-6 py-8",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"mb-8 animate-fade-in-up",children:[e.jsx("h1",{className:"text-4xl font-display font-bold text-gradient mb-4",children:"My Patients"}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"View your patient records and information"})]}),e.jsxs(N,{className:"shadow-card border-border bg-card",children:[e.jsx(b,{className:"flex flex-row items-center justify-between",children:e.jsxs("div",{children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-primary"}),"Patient List"]}),e.jsx(v,{children:"View all your patients"})]})}),e.jsxs(w,{children:[c&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:c}),l&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading patients..."}),e.jsxs("div",{className:"space-y-4",children:[i.map(t=>{console.log("Patient object:",t);const s=t.id||t.patient_id||t.user_id;return e.jsxs("div",{className:"flex justify-between items-start p-4 border border-border rounded-lg bg-muted/50 hover:bg-muted transition-smooth",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:t.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Email: ",t.email," | Phone: ",t.phone]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Age: ",t.age," | Address: ",t.address]}),t.medical_history&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 italic",children:["Medical History: ",t.medical_history]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["ID: ",s||"No ID found"]})]}),e.jsx("div",{className:"flex gap-2 ml-4",children:e.jsx(j,{onClick:()=>f(s,t.name),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700 hover:border-red-300",disabled:m===s||!s,children:m===s?e.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-red-600 border-t-transparent"}):e.jsx(P,{className:"h-4 w-4"})})})]},s||Math.random())}),i.length===0&&!l&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No patients found."})]})]})]})]})})]}),e.jsx(E,{})]})]})};export{V as default};
