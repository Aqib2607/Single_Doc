import{c as te,j as e,B as P,X as Le,r as a,C as k,a as Ie,f as U,P as Y,e as G,d as H,o as O,g as ze,i as de,m as me}from"./app-CEoN3nb7.js";import{H as Me}from"./Helmet-BTcaEctK.js";import{C as _,b as L,c as I,a as z,d as Oe}from"./card-Db-WEhk7.js";import{U as he,P as He,B as X,N as Fe,F as Be}from"./Footer-qMXzDiRv.js";import{T as Z,L as B}from"./triangle-alert-MLD6dFF1.js";import{C as se}from"./clock-Co820-Oy.js";import{T as xe}from"./trash-2-BXHwlNFd.js";import{D as ue,b as pe,a as fe,c as ge,d as be}from"./dialog-BZ70i1aA.js";import{a as We}from"./index-Bcg0Mu0T.js";import{c as $e}from"./index-BdQq_4o_.js";import{P as F}from"./pill-C3JZLNnZ.js";import{F as W}from"./file-text-CHhrgst4.js";import{E as je}from"./eye-3p-js2Mu.js";import"./Combination-BghPHJq8.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=te("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=te("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=te("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ye=({isOpen:t,onClose:r,onConfirm:s,title:o,message:n,confirmText:l="Confirm",cancelText:d="Cancel",isLoading:c=!1})=>t?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:r}),e.jsx("div",{className:"relative bg-white rounded-lg shadow-lg max-w-md w-full mx-4 p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Z,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:o}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:n}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(P,{variant:"outline",onClick:r,disabled:c,className:"px-4 py-2",children:d}),e.jsx(P,{variant:"destructive",onClick:s,disabled:c,className:"px-4 py-2",children:c?"Deleting...":l})]})]}),e.jsx("button",{onClick:r,disabled:c,className:"flex-shrink-0 text-gray-400 hover:text-gray-600","aria-label":"Close dialog",children:e.jsx(Le,{className:"h-5 w-5"})})]})})]}):null,Xe=()=>{const[t,r]=a.useState([]),[s,o]=a.useState(!0),[n,l]=a.useState(null),[d,c]=a.useState(null),[h,p]=a.useState(null),[x,f]=a.useState({isOpen:!1,appointmentId:null}),[i,b]=a.useState(null);a.useEffect(()=>{u()},[]);const u=async()=>{try{const m=localStorage.getItem("token"),y=await fetch("/api/patient-appointments",{headers:{Authorization:`Bearer ${m}`,Accept:"application/json"}});if(!y.ok)throw new Error("Failed to fetch appointments");const j=await y.json();r(j)}catch(m){l(m instanceof Error?m.message:"Failed to load appointments")}finally{o(!1)}},v=async(m,y)=>{c(m);try{const j=localStorage.getItem("token");if(!(await fetch(`/api/appointments/${m}`,{method:"PUT",headers:{Authorization:`Bearer ${j}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({status:y})})).ok)throw new Error("Failed to update appointment");await u()}catch(j){l(j instanceof Error?j.message:"Failed to update appointment")}finally{c(null)}},w=m=>{f({isOpen:!0,appointmentId:m})},S=async()=>{if(x.appointmentId){p(x.appointmentId);try{const m=localStorage.getItem("token"),y=await fetch(`/api/appointments/${x.appointmentId}`,{method:"DELETE",headers:{Authorization:`Bearer ${m}`,Accept:"application/json"}});if(!y.ok){const j=await y.json();throw new Error(j.error||"Failed to delete appointment")}b("Appointment deleted successfully"),await u(),setTimeout(()=>b(null),3e3)}catch(m){l(m instanceof Error?m.message:"Failed to delete appointment")}finally{p(null),f({isOpen:!1,appointmentId:null})}}},D=()=>{f({isOpen:!1,appointmentId:null})},M=m=>{switch(m){case"confirmed":return e.jsx(V,{className:"h-4 w-4 text-green-600"});case"cancelled":return e.jsx(Ue,{className:"h-4 w-4 text-red-600"});default:return e.jsx(ee,{className:"h-4 w-4 text-yellow-600"})}},T=m=>{switch(m){case"confirmed":return"text-green-600 bg-green-50 border-green-200";case"cancelled":return"text-red-600 bg-red-50 border-red-200";default:return"text-yellow-600 bg-yellow-50 border-yellow-200"}},R=m=>new Date(m).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),g=m=>new Date(`2000-01-01T${m}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return s?e.jsxs(_,{children:[e.jsx(L,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Recent Appointments"]})}),e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(B,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading appointments..."})]})})]}):n?e.jsxs(_,{children:[e.jsx(L,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Recent Appointments"]})}),e.jsx(z,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600 mb-4",children:n}),e.jsx(P,{onClick:u,variant:"outline",children:"Try Again"})]})})]}):e.jsxs(_,{children:[e.jsx(L,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-5 w-5"}),"Recent Appointments"]})}),e.jsxs(z,{children:[i&&e.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-green-600"}),e.jsx("p",{className:"text-green-800 text-sm",children:i})]})}),t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(k,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No appointments found"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Your upcoming appointments will appear here"})]}):e.jsx("div",{className:"space-y-4",children:t.map(m=>e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"font-medium",children:m.doctor})]}),e.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs border ${T(m.status)}`,children:[M(m.status),e.jsx("span",{className:"capitalize",children:m.status})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:R(m.appointment_date)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:g(m.appointment_time)})]})]}),m.consultation_type&&e.jsx("div",{className:"mb-3",children:e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:m.consultation_type.replace("-"," ")})}),m.reason&&e.jsx("div",{className:"mb-3",children:e.jsx("p",{className:"text-sm text-gray-700 line-clamp-2",children:m.reason})}),e.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t",children:[m.status==="pending"&&e.jsx(P,{size:"sm",variant:"destructive",onClick:()=>v(m.id,"cancelled"),disabled:d===m.id,children:d===m.id?e.jsx(B,{className:"h-3 w-3 animate-spin"}):"Cancel"}),m.status==="cancelled"&&e.jsx(P,{size:"sm",variant:"outline",onClick:()=>w(m.id),disabled:h===m.id,className:"text-red-600 border-red-300 hover:bg-red-50","aria-label":`Delete appointment with ${m.doctor}`,children:h===m.id?e.jsx(B,{className:"h-3 w-3 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"h-3 w-3 mr-1"}),"Delete"]})}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 ml-auto",children:[e.jsx(He,{className:"h-3 w-3"}),e.jsx("span",{children:m.phone})]})]})]},m.id))})]}),e.jsx(Ye,{isOpen:x.isOpen,onClose:D,onConfirm:S,title:"Delete Appointment",message:"Are you sure you want to permanently delete this appointment? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",isLoading:h!==null})]})};function Ve(t,r){return a.useReducer((s,o)=>r[s][o]??s,t)}var re="ScrollArea",[ve,yt]=Ie(re),[qe,C]=ve(re),we=a.forwardRef((t,r)=>{const{__scopeScrollArea:s,type:o="hover",dir:n,scrollHideDelay:l=600,...d}=t,[c,h]=a.useState(null),[p,x]=a.useState(null),[f,i]=a.useState(null),[b,u]=a.useState(null),[v,w]=a.useState(null),[S,D]=a.useState(0),[M,T]=a.useState(0),[R,g]=a.useState(!1),[m,y]=a.useState(!1),j=U(r,A=>h(A)),N=We(n);return e.jsx(qe,{scope:s,type:o,dir:N,scrollHideDelay:l,scrollArea:c,viewport:p,onViewportChange:x,content:f,onContentChange:i,scrollbarX:b,onScrollbarXChange:u,scrollbarXEnabled:R,onScrollbarXEnabledChange:g,scrollbarY:v,onScrollbarYChange:w,scrollbarYEnabled:m,onScrollbarYEnabledChange:y,onCornerWidthChange:D,onCornerHeightChange:T,children:e.jsx(Y.div,{dir:N,...d,ref:j,style:{position:"relative","--radix-scroll-area-corner-width":S+"px","--radix-scroll-area-corner-height":M+"px",...t.style}})})});we.displayName=re;var ye="ScrollAreaViewport",Ne=a.forwardRef((t,r)=>{const{__scopeScrollArea:s,children:o,nonce:n,...l}=t,d=C(ye,s),c=a.useRef(null),h=U(r,c,d.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(Y.div,{"data-radix-scroll-area-viewport":"",...l,ref:h,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:d.onContentChange,style:{minWidth:"100%",display:"table"},children:o})})]})});Ne.displayName=ye;var E="ScrollAreaScrollbar",ne=a.forwardRef((t,r)=>{const{forceMount:s,...o}=t,n=C(E,t.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:d}=n,c=t.orientation==="horizontal";return a.useEffect(()=>(c?l(!0):d(!0),()=>{c?l(!1):d(!1)}),[c,l,d]),n.type==="hover"?e.jsx(Je,{...o,ref:r,forceMount:s}):n.type==="scroll"?e.jsx(Ge,{...o,ref:r,forceMount:s}):n.type==="auto"?e.jsx(Se,{...o,ref:r,forceMount:s}):n.type==="always"?e.jsx(ae,{...o,ref:r}):null});ne.displayName=E;var Je=a.forwardRef((t,r)=>{const{forceMount:s,...o}=t,n=C(E,t.__scopeScrollArea),[l,d]=a.useState(!1);return a.useEffect(()=>{const c=n.scrollArea;let h=0;if(c){const p=()=>{window.clearTimeout(h),d(!0)},x=()=>{h=window.setTimeout(()=>d(!1),n.scrollHideDelay)};return c.addEventListener("pointerenter",p),c.addEventListener("pointerleave",x),()=>{window.clearTimeout(h),c.removeEventListener("pointerenter",p),c.removeEventListener("pointerleave",x)}}},[n.scrollArea,n.scrollHideDelay]),e.jsx(G,{present:s||l,children:e.jsx(Se,{"data-state":l?"visible":"hidden",...o,ref:r})})}),Ge=a.forwardRef((t,r)=>{const{forceMount:s,...o}=t,n=C(E,t.__scopeScrollArea),l=t.orientation==="horizontal",d=Q(()=>h("SCROLL_END"),100),[c,h]=Ve("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return a.useEffect(()=>{if(c==="idle"){const p=window.setTimeout(()=>h("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(p)}},[c,n.scrollHideDelay,h]),a.useEffect(()=>{const p=n.viewport,x=l?"scrollLeft":"scrollTop";if(p){let f=p[x];const i=()=>{const b=p[x];f!==b&&(h("SCROLL"),d()),f=b};return p.addEventListener("scroll",i),()=>p.removeEventListener("scroll",i)}},[n.viewport,l,h,d]),e.jsx(G,{present:s||c!=="hidden",children:e.jsx(ae,{"data-state":c==="hidden"?"hidden":"visible",...o,ref:r,onPointerEnter:H(t.onPointerEnter,()=>h("POINTER_ENTER")),onPointerLeave:H(t.onPointerLeave,()=>h("POINTER_LEAVE"))})})}),Se=a.forwardRef((t,r)=>{const s=C(E,t.__scopeScrollArea),{forceMount:o,...n}=t,[l,d]=a.useState(!1),c=t.orientation==="horizontal",h=Q(()=>{if(s.viewport){const p=s.viewport.offsetWidth<s.viewport.scrollWidth,x=s.viewport.offsetHeight<s.viewport.scrollHeight;d(c?p:x)}},10);return $(s.viewport,h),$(s.content,h),e.jsx(G,{present:o||l,children:e.jsx(ae,{"data-state":l?"visible":"hidden",...n,ref:r})})}),ae=a.forwardRef((t,r)=>{const{orientation:s="vertical",...o}=t,n=C(E,t.__scopeScrollArea),l=a.useRef(null),d=a.useRef(0),[c,h]=a.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),p=De(c.viewport,c.content),x={...o,sizes:c,onSizesChange:h,hasThumb:p>0&&p<1,onThumbChange:i=>l.current=i,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:i=>d.current=i};function f(i,b){return st(i,d.current,c,b)}return s==="horizontal"?e.jsx(Ke,{...x,ref:r,onThumbPositionChange:()=>{if(n.viewport&&l.current){const i=n.viewport.scrollLeft,b=ce(i,c,n.dir);l.current.style.transform=`translate3d(${b}px, 0, 0)`}},onWheelScroll:i=>{n.viewport&&(n.viewport.scrollLeft=i)},onDragScroll:i=>{n.viewport&&(n.viewport.scrollLeft=f(i,n.dir))}}):s==="vertical"?e.jsx(Qe,{...x,ref:r,onThumbPositionChange:()=>{if(n.viewport&&l.current){const i=n.viewport.scrollTop,b=ce(i,c);l.current.style.transform=`translate3d(0, ${b}px, 0)`}},onWheelScroll:i=>{n.viewport&&(n.viewport.scrollTop=i)},onDragScroll:i=>{n.viewport&&(n.viewport.scrollTop=f(i))}}):null}),Ke=a.forwardRef((t,r)=>{const{sizes:s,onSizesChange:o,...n}=t,l=C(E,t.__scopeScrollArea),[d,c]=a.useState(),h=a.useRef(null),p=U(r,h,l.onScrollbarXChange);return a.useEffect(()=>{h.current&&c(getComputedStyle(h.current))},[h]),e.jsx(Pe,{"data-orientation":"horizontal",...n,ref:p,sizes:s,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":K(s)+"px",...t.style},onThumbPointerDown:x=>t.onThumbPointerDown(x.x),onDragScroll:x=>t.onDragScroll(x.x),onWheelScroll:(x,f)=>{if(l.viewport){const i=l.viewport.scrollLeft+x.deltaX;t.onWheelScroll(i),Re(i,f)&&x.preventDefault()}},onResize:()=>{h.current&&l.viewport&&d&&o({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:h.current.clientWidth,paddingStart:J(d.paddingLeft),paddingEnd:J(d.paddingRight)}})}})}),Qe=a.forwardRef((t,r)=>{const{sizes:s,onSizesChange:o,...n}=t,l=C(E,t.__scopeScrollArea),[d,c]=a.useState(),h=a.useRef(null),p=U(r,h,l.onScrollbarYChange);return a.useEffect(()=>{h.current&&c(getComputedStyle(h.current))},[h]),e.jsx(Pe,{"data-orientation":"vertical",...n,ref:p,sizes:s,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":K(s)+"px",...t.style},onThumbPointerDown:x=>t.onThumbPointerDown(x.y),onDragScroll:x=>t.onDragScroll(x.y),onWheelScroll:(x,f)=>{if(l.viewport){const i=l.viewport.scrollTop+x.deltaY;t.onWheelScroll(i),Re(i,f)&&x.preventDefault()}},onResize:()=>{h.current&&l.viewport&&d&&o({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:h.current.clientHeight,paddingStart:J(d.paddingTop),paddingEnd:J(d.paddingBottom)}})}})}),[Ze,Ce]=ve(E),Pe=a.forwardRef((t,r)=>{const{__scopeScrollArea:s,sizes:o,hasThumb:n,onThumbChange:l,onThumbPointerUp:d,onThumbPointerDown:c,onThumbPositionChange:h,onDragScroll:p,onWheelScroll:x,onResize:f,...i}=t,b=C(E,s),[u,v]=a.useState(null),w=U(r,j=>v(j)),S=a.useRef(null),D=a.useRef(""),M=b.viewport,T=o.content-o.viewport,R=O(x),g=O(h),m=Q(f,10);function y(j){if(S.current){const N=j.clientX-S.current.left,A=j.clientY-S.current.top;p({x:N,y:A})}}return a.useEffect(()=>{const j=N=>{const A=N.target;(u==null?void 0:u.contains(A))&&R(N,T)};return document.addEventListener("wheel",j,{passive:!1}),()=>document.removeEventListener("wheel",j,{passive:!1})},[M,u,T,R]),a.useEffect(g,[o,g]),$(u,m),$(b.content,m),e.jsx(Ze,{scope:s,scrollbar:u,hasThumb:n,onThumbChange:O(l),onThumbPointerUp:O(d),onThumbPositionChange:g,onThumbPointerDown:O(c),children:e.jsx(Y.div,{...i,ref:w,style:{position:"absolute",...i.style},onPointerDown:H(t.onPointerDown,j=>{j.button===0&&(j.target.setPointerCapture(j.pointerId),S.current=u.getBoundingClientRect(),D.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",b.viewport&&(b.viewport.style.scrollBehavior="auto"),y(j))}),onPointerMove:H(t.onPointerMove,y),onPointerUp:H(t.onPointerUp,j=>{const N=j.target;N.hasPointerCapture(j.pointerId)&&N.releasePointerCapture(j.pointerId),document.body.style.webkitUserSelect=D.current,b.viewport&&(b.viewport.style.scrollBehavior=""),S.current=null})})})}),q="ScrollAreaThumb",Ae=a.forwardRef((t,r)=>{const{forceMount:s,...o}=t,n=Ce(q,t.__scopeScrollArea);return e.jsx(G,{present:s||n.hasThumb,children:e.jsx(et,{ref:r,...o})})}),et=a.forwardRef((t,r)=>{const{__scopeScrollArea:s,style:o,...n}=t,l=C(q,s),d=Ce(q,s),{onThumbPositionChange:c}=d,h=U(r,f=>d.onThumbChange(f)),p=a.useRef(void 0),x=Q(()=>{p.current&&(p.current(),p.current=void 0)},100);return a.useEffect(()=>{const f=l.viewport;if(f){const i=()=>{if(x(),!p.current){const b=rt(f,c);p.current=b,c()}};return c(),f.addEventListener("scroll",i),()=>f.removeEventListener("scroll",i)}},[l.viewport,x,c]),e.jsx(Y.div,{"data-state":d.hasThumb?"visible":"hidden",...n,ref:h,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...o},onPointerDownCapture:H(t.onPointerDownCapture,f=>{const b=f.target.getBoundingClientRect(),u=f.clientX-b.left,v=f.clientY-b.top;d.onThumbPointerDown({x:u,y:v})}),onPointerUp:H(t.onPointerUp,d.onThumbPointerUp)})});Ae.displayName=q;var le="ScrollAreaCorner",Ee=a.forwardRef((t,r)=>{const s=C(le,t.__scopeScrollArea),o=!!(s.scrollbarX&&s.scrollbarY);return s.type!=="scroll"&&o?e.jsx(tt,{...t,ref:r}):null});Ee.displayName=le;var tt=a.forwardRef((t,r)=>{const{__scopeScrollArea:s,...o}=t,n=C(le,s),[l,d]=a.useState(0),[c,h]=a.useState(0),p=!!(l&&c);return $(n.scrollbarX,()=>{var f;const x=((f=n.scrollbarX)==null?void 0:f.offsetHeight)||0;n.onCornerHeightChange(x),h(x)}),$(n.scrollbarY,()=>{var f;const x=((f=n.scrollbarY)==null?void 0:f.offsetWidth)||0;n.onCornerWidthChange(x),d(x)}),p?e.jsx(Y.div,{...o,ref:r,style:{width:l,height:c,position:"absolute",right:n.dir==="ltr"?0:void 0,left:n.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function J(t){return t?parseInt(t,10):0}function De(t,r){const s=t/r;return isNaN(s)?0:s}function K(t){const r=De(t.viewport,t.content),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,o=(t.scrollbar.size-s)*r;return Math.max(o,18)}function st(t,r,s,o="ltr"){const n=K(s),l=n/2,d=r||l,c=n-d,h=s.scrollbar.paddingStart+d,p=s.scrollbar.size-s.scrollbar.paddingEnd-c,x=s.content-s.viewport,f=o==="ltr"?[0,x]:[x*-1,0];return Te([h,p],f)(t)}function ce(t,r,s="ltr"){const o=K(r),n=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,l=r.scrollbar.size-n,d=r.content-r.viewport,c=l-o,h=s==="ltr"?[0,d]:[d*-1,0],p=$e(t,h);return Te([0,d],[0,c])(p)}function Te(t,r){return s=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const o=(r[1]-r[0])/(t[1]-t[0]);return r[0]+o*(s-t[0])}}function Re(t,r){return t>0&&t<r}var rt=(t,r=()=>{})=>{let s={left:t.scrollLeft,top:t.scrollTop},o=0;return function n(){const l={left:t.scrollLeft,top:t.scrollTop},d=s.left!==l.left,c=s.top!==l.top;(d||c)&&r(),s=l,o=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(o)};function Q(t,r){const s=O(t),o=a.useRef(0);return a.useEffect(()=>()=>window.clearTimeout(o.current),[]),a.useCallback(()=>{window.clearTimeout(o.current),o.current=window.setTimeout(s,r)},[s,r])}function $(t,r){const s=O(r);ze(()=>{let o=0;if(t){const n=new ResizeObserver(()=>{cancelAnimationFrame(o),o=window.requestAnimationFrame(s)});return n.observe(t),()=>{window.cancelAnimationFrame(o),n.unobserve(t)}}},[t,s])}var ke=we,nt=Ne,at=Ee;const oe=a.forwardRef(({className:t,children:r,...s},o)=>e.jsxs(ke,{ref:o,className:de("relative overflow-hidden",t),...s,children:[e.jsx(nt,{className:"h-full w-full rounded-[inherit]",children:r}),e.jsx(_e,{}),e.jsx(at,{})]}));oe.displayName=ke.displayName;const _e=a.forwardRef(({className:t,orientation:r="vertical",...s},o)=>e.jsx(ne,{ref:o,orientation:r,className:de("flex touch-none select-none transition-colors",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...s,children:e.jsx(Ae,{className:"relative flex-1 rounded-full bg-border"})}));_e.displayName=ne.displayName;const lt=()=>{const[t,r]=a.useState([]),[s,o]=a.useState(!0),[n,l]=a.useState(null),[d,c]=a.useState(!1);a.useEffect(()=>{h()},[]);const h=async()=>{try{const u=localStorage.getItem("token");if(!u){l("Authentication required"),o(!1);return}const v=await fetch("/api/patient/prescriptions",{headers:{Authorization:`Bearer ${u}`,Accept:"application/json"}});if(!v.ok)throw new Error("Failed to fetch prescriptions");const w=await v.json();r(w)}catch(u){l(u instanceof Error?u.message:"Failed to load prescriptions")}finally{o(!1)}},p=u=>new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),x=u=>{const v=u.is_expired??(u.end_date&&new Date(u.end_date)<new Date),w=u.is_currently_active??(u.is_active&&!v);return v?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"Expired"}):w?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Active"}):e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800",children:"Inactive"})};if(s)return e.jsxs(_,{children:[e.jsx(L,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"My Prescriptions"]})}),e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(B,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading prescriptions..."})]})})]});if(n)return e.jsxs(_,{children:[e.jsx(L,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"My Prescriptions"]})}),e.jsx(z,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-600 mb-4",children:n})]})})]});const f=t[0],i=t.length>1,b=({prescription:u,isLatest:v=!1})=>e.jsxs("div",{className:`border rounded-lg p-4 hover:shadow-md transition-all duration-200 bg-white ${v?"ring-2 ring-blue-100":""}`,children:[v&&i&&e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800 font-medium",children:"Most Recent"})}),e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-900",children:u.medication_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[u.dosage," â€¢ ",u.frequency]})]}),x(u)]}),u.instructions&&e.jsx("div",{className:"mb-3",children:e.jsxs("p",{className:"text-sm text-gray-700 bg-blue-50 p-3 rounded border-l-4 border-blue-200",children:[e.jsx("strong",{children:"Instructions:"})," ",u.instructions]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Start Date:"}),e.jsx("p",{className:"font-medium",children:p(u.start_date)})]})]}),u.end_date&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"End Date:"}),e.jsx("p",{className:"font-medium",children:p(u.end_date)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Refills:"}),e.jsxs("p",{className:"font-medium",children:[u.refills_remaining," remaining"]})]})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(he,{className:"h-3 w-3"}),e.jsxs("span",{children:["Prescribed on ",p(u.created_at)]})]})})]});return e.jsxs(_,{children:[e.jsx(L,{children:e.jsxs(I,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"My Prescriptions"]})}),e.jsx(z,{children:t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(W,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"No prescriptions found"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Your prescription history will appear here"})]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{prescription:f,isLatest:!0}),i&&e.jsx("div",{className:"mt-4 text-center",children:e.jsxs(ue,{open:d,onOpenChange:c,children:[e.jsx(pe,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:"hover:bg-blue-50 hover:border-blue-300 transition-colors duration-300","aria-label":`View all ${t.length} prescriptions`,children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"View All (",t.length,")"]})}),e.jsxs(fe,{className:"max-w-[90vw] md:max-w-[60vw] max-h-[90vh] transition-all duration-300 ease-in-out","aria-labelledby":"prescriptions-modal-title","aria-describedby":"prescriptions-modal-description",children:[e.jsx(ge,{children:e.jsxs(be,{id:"prescriptions-modal-title",className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"All Prescriptions (",t.length,")"]})}),e.jsx("div",{id:"prescriptions-modal-description",className:"sr-only",children:"Complete list of all your prescriptions with details"}),e.jsx(oe,{className:"h-[70vh] pr-4",children:e.jsx("div",{className:"space-y-4",children:t.map(u=>e.jsx(b,{prescription:u},u.id))})})]})]})})]})})]})},ot=({triggerButton:t})=>{const{user:r}=me(),[s,o]=a.useState([]),[n,l]=a.useState(!1),[d,c]=a.useState(""),[h,p]=a.useState(!1),[x,f]=a.useState(null),[i,b]=a.useState(null),[u,v]=a.useState(""),w=a.useCallback(async()=>{if(!r||r.role!=="patient"){c("Invalid patient access");return}if(!r.patient_id){c("Invalid patient ID");return}l(!0),c("");try{const m=localStorage.getItem("token");if(!m)throw new Error("Authentication required");const y=await fetch("/api/patient-medical-records",{headers:{Authorization:`Bearer ${m}`,"Content-Type":"application/json"}});if(y.ok){const j=await y.json();o(j||[])}else if(y.status===404)o([]);else throw new Error(`Failed to load records (${y.status})`)}catch(m){const y=m instanceof Error?m.message:"Failed to load medical records";c(y),o([])}finally{l(!1)}},[r]);a.useEffect(()=>{h&&(w(),v(""))},[h,w]);const S=g=>{switch(g.toLowerCase()){case"complete":return e.jsx(V,{className:"h-4 w-4 text-green-600"});case"reviewed":return e.jsx(je,{className:"h-4 w-4 text-blue-600"});default:return e.jsx(se,{className:"h-4 w-4 text-yellow-600"})}},D=g=>{switch(g.toLowerCase()){case"complete":return"bg-green-100 text-green-800";case"reviewed":return"bg-blue-100 text-blue-800";default:return"bg-yellow-100 text-yellow-800"}},M=g=>new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T=async g=>{var m;f(g),c(""),v("");try{const y=localStorage.getItem("token");if(!y)throw new Error("Authentication token not found. Please log in again.");const j=await fetch(`/api/medical-records/${g}`,{method:"DELETE",headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"}});if(j.ok){const N=(m=s.find(A=>A.id===g))==null?void 0:m.title;o(A=>A.filter(ie=>ie.id!==g)),b(null),v(`Record "${N}" has been deleted successfully.`),setTimeout(()=>v(""),3e3)}else{let N="Failed to delete record";throw j.status===401?N="Authentication expired. Please log in again.":j.status===403?N="You do not have permission to delete this record.":j.status===404&&(N="Record not found. It may have already been deleted."),new Error(N)}}catch(y){const j=y instanceof Error?y.message:"An unexpected error occurred while deleting the record.";console.error("[Delete] Error:",j,y),c(j)}finally{f(null)}},R=e.jsxs(P,{size:"sm",variant:"outline",className:"border-border",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"View All Medical Records"]});return e.jsxs(ue,{open:h,onOpenChange:p,children:[e.jsx(pe,{asChild:!0,children:t||R}),e.jsxs(fe,{className:"max-w-4xl max-h-[85vh]","aria-labelledby":"medical-records-title","aria-describedby":"medical-records-description",children:[e.jsx(ge,{children:e.jsxs(be,{id:"medical-records-title",className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-primary"}),"All Medical Records",r&&r.role==="patient"&&e.jsxs(X,{variant:"outline",className:"ml-2",children:["Patient ID: ",r.patient_id]})]})}),e.jsx("div",{id:"medical-records-description",className:"sr-only",children:"Complete list of medical records for the current patient"}),u&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:u})]})}),e.jsx(oe,{className:"h-[60vh] pr-4",children:n?e.jsxs("div",{className:"flex items-center justify-center py-8 text-muted-foreground",children:[e.jsx(B,{className:"h-6 w-6 animate-spin mr-2"}),e.jsx("div",{children:"Loading medical records..."})]}):d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{className:"h-8 w-8 text-red-600 mx-auto mb-4"}),e.jsx("div",{className:"text-red-600 mb-4",children:d}),e.jsx(P,{onClick:w,variant:"outline",size:"sm",children:"Try Again"})]}):s.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(W,{className:"h-8 w-8 mx-auto mb-4 opacity-50"}),e.jsx("div",{children:"No medical records found for this patient"})]}):e.jsx("div",{className:"space-y-4",children:s.map(g=>e.jsxs("div",{className:"border border-border rounded-lg p-4 bg-card hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[g.critical_flag&&e.jsx(Z,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground text-lg",children:g.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(X,{variant:"secondary",className:"text-xs",children:g.record_type}),e.jsx(X,{className:`text-xs ${D(g.status)}`,children:e.jsxs("span",{className:"flex items-center gap-1",children:[S(g.status),g.status]})}),g.critical_flag&&e.jsx(X,{variant:"destructive",className:"text-xs",children:"Critical"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(k,{className:"h-4 w-4"}),M(g.record_date)]}),e.jsx("div",{className:"flex items-center gap-2",children:i===g.id?e.jsxs("div",{className:"flex gap-1",children:[e.jsx(P,{size:"sm",variant:"destructive",onClick:()=>T(g.id),disabled:x===g.id,className:"h-8 px-2","aria-label":"Confirm delete",children:x===g.id?e.jsx(B,{className:"h-3 w-3 animate-spin"}):"Confirm"}),e.jsx(P,{size:"sm",variant:"outline",onClick:()=>b(null),className:"h-8 px-2","aria-label":"Cancel delete",children:"Cancel"})]}):e.jsxs(P,{size:"sm",variant:"destructive",onClick:()=>b(g.id),disabled:x===g.id,className:"h-8 px-2","aria-label":`Delete record: ${g.title}`,title:"Delete this medical record permanently",children:[e.jsx(xe,{className:"h-3 w-3 mr-1"}),"Delete"]})})]})]}),g.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2 leading-relaxed",children:g.description}),g.doctor_name&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Doctor: ",g.doctor_name]})]},g.id))})}),s.length>0&&e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-border text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Total Records: ",s.length]}),e.jsxs("span",{children:["Last Updated: ",new Date().toLocaleString()]})]})]})]})},Nt=()=>{const{user:t}=me(),[r,s]=a.useState([]),[o,n]=a.useState([]),[l,d]=a.useState([]),[c,h]=a.useState(!0);a.useEffect(()=>{const i=async()=>{try{const v=localStorage.getItem("token"),w=await fetch("/api/patient-appointments",{headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});if(w.ok){const S=await w.json();s(S)}else s([])}catch(v){console.error("Error fetching appointments:",v)}},b=async()=>{try{const v=localStorage.getItem("token");if(!v){console.error("No authentication token found"),n([]);return}const w=await fetch("/api/patient/prescriptions",{headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});if(w.ok){const S=await w.json();n(S)}else console.error("Failed to fetch prescriptions:",w.status,w.statusText),n([])}catch(v){console.error("Error fetching prescriptions:",v),n([])}finally{h(!1)}},u=async()=>{try{const v=localStorage.getItem("token");if(!v){console.error("No authentication token found"),d([]);return}const w=await fetch("/api/patient-medical-records",{headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});if(w.ok){const S=await w.json();d(S)}else console.error("Failed to fetch medical records:",w.status,w.statusText),d([])}catch(v){console.error("Error fetching medical records:",v),d([])}};t!=null&&t.email&&(i(),b(),u())},[t==null?void 0:t.email]);const p=r.filter(i=>new Date(i.appointment_date)>=new Date),x=o.filter(i=>{const b=!i.end_date||new Date(i.end_date)>=new Date;return i.is_active&&b}),f=[{icon:k,label:"Upcoming Appointments",value:p.length.toString(),color:"text-primary"},{icon:F,label:"Active Prescriptions",value:x.length.toString(),color:"text-primary"},{icon:W,label:"Medical Records",value:l.length.toString(),color:"text-primary"}];return e.jsxs(e.Fragment,{children:[e.jsxs(Me,{children:[e.jsx("title",{children:"Patient Dashboard - Healthcare Portal"}),e.jsx("meta",{name:"description",content:"Manage your healthcare appointments and records"})]}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(Fe,{}),e.jsx("main",{className:"pt-24 px-4 py-8",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"mb-12 animate-fade-in-up",children:[e.jsxs("h1",{className:"text-4xl md:text-5xl font-display font-bold text-gradient mb-4",children:["Welcome, ",t==null?void 0:t.name,"!"]}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"Here's your health dashboard overview"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12",children:f.map((i,b)=>e.jsxs(_,{className:"shadow-card border-border bg-card hover:shadow-elegant transition-smooth animate-fade-in-up",style:{animationDelay:`${b*.1}s`},children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(I,{className:"text-sm font-medium text-foreground",children:i.label}),e.jsx(i.icon,{className:`h-5 w-5 ${i.color}`})]}),e.jsx(z,{children:e.jsx("div",{className:"text-3xl font-bold text-foreground",children:i.value})})]},b))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.5s"},children:e.jsx(Xe,{})}),e.jsx("div",{className:"animate-fade-in-up",style:{animationDelay:"0.6s"},children:e.jsx(lt,{})})]}),e.jsx("div",{className:"mt-12",children:e.jsxs(_,{className:"shadow-card border-border bg-card animate-fade-in-up",style:{animationDelay:"0.8s"},children:[e.jsxs(L,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(I,{className:"text-foreground flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-primary"}),"Medical Records"]}),e.jsx(Oe,{className:"text-muted-foreground",children:"Your recent medical records and test results"})]}),e.jsx(ot,{})]}),e.jsx(z,{children:e.jsx("div",{className:"space-y-4",children:c?e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"Loading medical records..."}):l.length>0?l.slice(0,3).map(i=>e.jsx("div",{className:"flex justify-between items-start p-4 border border-border rounded-lg bg-muted/50 hover:bg-muted transition-smooth",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${i.status==="complete"?"bg-green-500":i.status==="reviewed"?"bg-blue-500":"bg-yellow-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground",children:i.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.record_type}),i.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:i.description}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(i.record_date).toLocaleDateString()}),e.jsx("p",{className:"text-xs text-primary mt-1 capitalize",children:i.status})]})]})},i.id)):e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No medical records available"})})})]})})]})}),e.jsx(Be,{})]})]})};export{Nt as default};
