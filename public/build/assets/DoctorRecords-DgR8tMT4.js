import{r as n,j as e,B as m,X as A}from"./app-Ctcvl0L3.js";import{H as B}from"./Helmet-Co23iFK2.js";import{C as $,b as L,c as M,d as V,a as q}from"./card-DZzBpZMV.js";import{I as _}from"./input-Ljzp5E3d.js";import{L as l}from"./label-DkcLJd5U.js";import{T as O}from"./textarea-CyBfWePp.js";import{S as p,a as u,b as j,c as f,d as a}from"./select-kcfAJY73.js";import{N as H,F as U}from"./Footer-Dg67bZa1.js";import{D as X}from"./DoctorSidebar-B20k-3e_.js";import{F as J}from"./file-text-DXNCTGNo.js";import{P as G}from"./plus-ChQ4m0mi.js";import{S as K}from"./square-pen-C2wLsbA_.js";import{T as Q}from"./trash-2-D3X408Vn.js";import"./index-BdQq_4o_.js";import"./index-BuAs8_WM.js";import"./Combination-CjoguCJq.js";import"./index-n9-Tr9Se.js";import"./chevron-down-CDPvgecV.js";import"./users-DMPgEr1v.js";import"./stethoscope-B07MkWAq.js";import"./message-square-C8sKfbal.js";import"./pill-B2wRk4OR.js";const ve=()=>{const[g,k]=n.useState([]),[v,T]=n.useState([]),[D,x]=n.useState(!1),[d,y]=n.useState(null),[b,N]=n.useState(!1),[S,c]=n.useState(""),[r,i]=n.useState({patient_id:"",record_type:"",title:"",description:"",status:"pending",record_date:""});n.useEffect(()=>{h(),E()},[]);const h=async()=>{try{const t=localStorage.getItem("token"),s=await fetch("/api/medical-records",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(s.ok){const o=await s.json();k(o)}}catch(t){console.error("Error fetching records:",t)}},E=async()=>{try{const t=localStorage.getItem("token"),s=await fetch("/api/patients",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(s.ok){const o=await s.json();T(o)}}catch(t){console.error("Error fetching patients:",t)}},P=async t=>{if(t.preventDefault(),c(""),!r.patient_id||!r.record_type||!r.title||!r.record_date){c("Please fill in all required fields");return}N(!0);try{const s=localStorage.getItem("token"),o=d?`/api/medical-records/${d.id}`:"/api/medical-records",C=await fetch(o,{method:d?"PUT":"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(C.ok)await h(),w(),alert(d?"Record updated successfully!":"Record added successfully!");else{const z=await C.json().catch(()=>({message:"Unknown error occurred"}));c(z.message||"Failed to save record")}}catch(s){c("Network error: "+s.message)}finally{N(!1)}},F=t=>{var s;y(t),i({patient_id:((s=t.patient_id)==null?void 0:s.toString())||"",record_type:t.record_type||"",title:t.title||"",description:t.description||"",status:t.status||"pending",record_date:t.record_date||""}),x(!0),c("")},I=async t=>{if(confirm("Are you sure you want to delete this record?"))try{const s=localStorage.getItem("token");(await fetch(`/api/medical-records/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok&&(h(),alert("Record deleted successfully!"))}catch(s){console.error("Error deleting record:",s)}},w=()=>{i({patient_id:"",record_type:"",title:"",description:"",status:"pending",record_date:""}),y(null),x(!1),c("")};return e.jsxs(e.Fragment,{children:[e.jsx(B,{children:e.jsx("title",{children:"Medical Records - Doctor Dashboard"})}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(H,{}),e.jsxs("div",{className:"flex pt-20",children:[e.jsx(X,{}),e.jsx("main",{className:"flex-1 px-6 py-8",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"mb-8 animate-fade-in-up",children:[e.jsx("h1",{className:"text-4xl font-display font-bold text-gradient mb-4",children:"Medical Records"}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"Manage patient medical records and documents"})]}),e.jsxs($,{className:"shadow-card border-border bg-card",children:[e.jsxs(L,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5 text-primary"}),"Patient Records"]}),e.jsx(V,{children:"View and manage medical documents"})]}),e.jsxs(m,{onClick:()=>x(!0),className:"gradient-primary shadow-elegant",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Add Record"]})]}),e.jsxs(q,{children:[D&&e.jsxs("form",{onSubmit:P,className:"mb-6 p-4 border border-border rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:d?"Edit Record":"New Medical Record"}),e.jsx(m,{type:"button",onClick:w,variant:"ghost",size:"sm",children:e.jsx(A,{className:"h-4 w-4"})})]}),S&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:S}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Patient *"}),e.jsxs(p,{value:r.patient_id,onValueChange:t=>i({...r,patient_id:t}),children:[e.jsx(u,{children:e.jsx(j,{placeholder:"Select patient"})}),e.jsx(f,{children:v.map(t=>e.jsx(a,{value:t.id.toString(),children:t.name},t.id))})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Record Type *"}),e.jsxs(p,{value:r.record_type,onValueChange:t=>i({...r,record_type:t}),children:[e.jsx(u,{children:e.jsx(j,{placeholder:"Select type"})}),e.jsxs(f,{children:[e.jsx(a,{value:"Lab Report",children:"Lab Report"}),e.jsx(a,{value:"X-Ray",children:"X-Ray"}),e.jsx(a,{value:"MRI",children:"MRI"}),e.jsx(a,{value:"CT Scan",children:"CT Scan"}),e.jsx(a,{value:"Blood Test",children:"Blood Test"}),e.jsx(a,{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Title *"}),e.jsx(_,{value:r.title,onChange:t=>i({...r,title:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Record Date *"}),e.jsx(_,{type:"date",value:r.record_date,onChange:t=>i({...r,record_date:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Status"}),e.jsxs(p,{value:r.status,onValueChange:t=>i({...r,status:t}),children:[e.jsx(u,{children:e.jsx(j,{})}),e.jsxs(f,{children:[e.jsx(a,{value:"pending",children:"Pending"}),e.jsx(a,{value:"complete",children:"Complete"}),e.jsx(a,{value:"reviewed",children:"Reviewed"})]})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{children:"Description"}),e.jsx(O,{value:r.description,onChange:t=>i({...r,description:t.target.value})})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(m,{type:"submit",className:"w-full",disabled:b,children:b?"Saving...":d?"Update Record":"Add Record"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[g.map(t=>{const s=v.find(R=>R.id===t.patient_id),o=new Date(t.record_date).toLocaleDateString();return e.jsxs("div",{className:"flex justify-between items-start p-4 border border-border rounded-lg bg-muted/50 hover:bg-muted transition-smooth",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:s?s.name:`Patient ID: ${t.patient_id}`}),e.jsx("p",{className:"text-sm text-primary font-medium",children:t.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Type: ",t.record_type," | Date: ",o]}),e.jsxs("p",{className:`text-sm capitalize ${t.status==="complete"?"text-green-600":t.status==="reviewed"?"text-blue-600":"text-yellow-600"}`,children:["Status: ",t.status]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1 italic",children:t.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{onClick:()=>F(t),size:"sm",variant:"outline",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(m,{onClick:()=>I(t.id),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:e.jsx(Q,{className:"h-4 w-4"})})]})]},t.id)}),g.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'No medical records found. Click "Add Record" to create your first record.'})]})]})]})]})})]}),e.jsx(U,{})]})]})};export{ve as default};
