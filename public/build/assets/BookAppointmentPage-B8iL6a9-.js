import{l as I,m as D,r as m,j as e,C as A,B as _}from"./app-vJQ3I6dV.js";import{I as x}from"./input-CqXuVT5z.js";import{L as t}from"./label-D96JMsxO.js";import{T as B}from"./textarea-DIc7Hp2p.js";import{S as j,a as u,b as g,c as f,d as r}from"./select-DfWBD2AQ.js";import{C as M,b as E,c as q,d as V,a as L}from"./card-D_TdOCn4.js";import{C as O}from"./checkbox-CwNjGK_9.js";import{N as z,U as T,F as R}from"./Footer-C4ODtmGP.js";import{T as U,L as Y}from"./triangle-alert--WTHSHkL.js";import"./index-BdQq_4o_.js";import"./index-dSGg7dLG.js";import"./Combination-BbuKXahY.js";import"./index-Blj7CJ4q.js";import"./chevron-down-GzKXyq84.js";const ne=()=>{const N=I(),{user:n}=D(),i=!!n,[k,F]=m.useState([]),[a,v]=m.useState({name:"",email:"",phone:"",date:"",time:"",doctor_id:"",consultationType:"",reason:"",termsAccepted:!1}),[y,b]=m.useState(!1),[o,p]=m.useState({}),[C,S]=m.useState("");m.useEffect(()=>{(async()=>{try{const l=await fetch("/api/doctors");if(l.ok){const d=await l.json();F(d)}}catch(l){console.error("Failed to fetch doctors:",l)}})()},[]);const P=async s=>{s.preventDefault(),b(!0),p({}),S("");const l=i?{date:a.date,time:a.time,doctor_id:parseInt(a.doctor_id),consultationType:a.consultationType,reason:a.reason,termsAccepted:a.termsAccepted}:{name:a.name,email:a.email,phone:a.phone,date:a.date,time:a.time,doctor_id:parseInt(a.doctor_id),reason:a.reason};try{const d=localStorage.getItem("token"),w=await fetch("/api/book-appointment",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",...d&&{Authorization:`Bearer ${d}`}},body:JSON.stringify(l)}),h=await w.json();w.ok&&h.success?(S(h.message),v({name:"",email:"",phone:"",date:"",time:"",consultationType:"",doctor_id:"",reason:"",termsAccepted:!1}),setTimeout(()=>{N(i?"/patient-dashboard":"/")},2e3)):p(h.errors||{general:[h.message]})}catch{p({general:["Network error. Please try again."]})}finally{b(!1)}},c=(s,l)=>{v(d=>({...d,[s]:l}))};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(z,{}),e.jsx("div",{className:"pt-20",children:e.jsx("div",{className:"container mx-auto px-4 py-16",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-display font-bold text-gradient mb-6",children:"Book Your Appointment"}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:i?`Welcome back, ${n==null?void 0:n.name}! Schedule your consultation easily.`:"Schedule your consultation with our healthcare professionals"})]}),e.jsxs(M,{className:"shadow-card border-border bg-card",children:[e.jsxs(E,{children:[e.jsxs(q,{className:"flex items-center gap-2 text-foreground",children:[e.jsx(A,{className:"h-5 w-5 text-primary"}),i?"Patient Appointment":"Guest Appointment"]}),e.jsx(V,{className:"text-muted-foreground",children:i?"Your information is automatically filled from your profile":"Please fill in all required information to book your appointment"})]}),e.jsx(L,{children:e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[C&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-5 w-5 text-green-600",children:"âœ“"}),e.jsx("p",{className:"text-green-800 font-medium",children:C})]})}),o.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(U,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Booking Failed"}),o.general.map((s,l)=>e.jsx("p",{className:"text-sm text-red-700",children:s},l))]})]})}),!i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"Personal Information"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"name",children:"Full Name *"}),e.jsx(x,{id:"name",value:a.name,onChange:s=>c("name",s.target.value),required:!0}),o.name&&e.jsx("p",{className:"text-sm text-red-600",children:o.name[0]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(x,{id:"phone",type:"tel",value:a.phone,onChange:s=>c("phone",s.target.value),required:!0}),o.phone&&e.jsx("p",{className:"text-sm text-red-600",children:o.phone[0]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"email",children:"Email (Optional)"}),e.jsx(x,{id:"email",type:"email",value:a.email,onChange:s=>c("email",s.target.value)}),o.email&&e.jsx("p",{className:"text-sm text-red-600",children:o.email[0]})]})]}),i&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(T,{className:"h-4 w-4"}),"Patient Information"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{className:"text-sm text-gray-600",children:"Name"}),e.jsx("p",{className:"font-medium",children:n==null?void 0:n.name})]}),e.jsxs("div",{children:[e.jsx(t,{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium",children:n==null?void 0:n.email})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Appointment Details"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"date",children:"Appointment Date *"}),e.jsx(x,{id:"date",type:"date",value:a.date,onChange:s=>c("date",s.target.value),min:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"time",children:"Appointment Time *"}),e.jsxs(j,{onValueChange:s=>c("time",s),children:[e.jsx(u,{children:e.jsx(g,{placeholder:"Select time"})}),e.jsxs(f,{children:[e.jsx(r,{value:"09:00",children:"9:00 AM"}),e.jsx(r,{value:"10:00",children:"10:00 AM"}),e.jsx(r,{value:"11:00",children:"11:00 AM"}),e.jsx(r,{value:"14:00",children:"2:00 PM"}),e.jsx(r,{value:"15:00",children:"3:00 PM"}),e.jsx(r,{value:"16:00",children:"4:00 PM"})]})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"doctor_id",children:"Select Doctor *"}),e.jsxs(j,{onValueChange:s=>c("doctor_id",s),children:[e.jsx(u,{children:e.jsx(g,{placeholder:"Choose a doctor"})}),e.jsx(f,{children:k.map(s=>e.jsxs(r,{value:s.doctor_id.toString(),children:[s.name," - ",s.specialization]},s.doctor_id))})]}),o.doctor_id&&e.jsx("p",{className:"text-sm text-red-600",children:o.doctor_id[0]})]}),i&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"consultationType",children:"Consultation Type"}),e.jsxs(j,{onValueChange:s=>c("consultationType",s),children:[e.jsx(u,{children:e.jsx(g,{placeholder:"Select type"})}),e.jsxs(f,{children:[e.jsx(r,{value:"in-person",children:"In-Person"}),e.jsx(r,{value:"telemedicine",children:"Telemedicine"}),e.jsx(r,{value:"follow-up",children:"Follow-up"}),e.jsx(r,{value:"consultation",children:"Consultation"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"reason",children:"Reason for Visit"}),e.jsx(B,{id:"reason",value:a.reason,onChange:s=>c("reason",s.target.value),placeholder:"Please describe your symptoms or reason for the appointment",rows:4})]})]}),i&&e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(O,{id:"terms",checked:a.termsAccepted,onCheckedChange:s=>c("termsAccepted",s),required:!0}),e.jsx(t,{htmlFor:"terms",className:"text-sm leading-relaxed",children:"I agree to the Terms of Service and Privacy Policy. I understand that appointment confirmation is subject to availability."})]}),e.jsx(_,{type:"submit",className:"w-full gradient-primary shadow-elegant hover:shadow-glow",disabled:y||i&&!a.termsAccepted,children:y?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"mr-2 h-4 w-4 animate-spin"}),"Booking Appointment..."]}):"Book Appointment"})]})})]})]})})}),e.jsx(R,{})]})};export{ne as default};
