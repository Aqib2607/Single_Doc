import{a as W,r,f as z,j as e,P as I,d as F,e as Q,p as Z,b as ee,i as D,l as te,C as se,B as re}from"./app-Ctcvl0L3.js";import{I as E}from"./input-Ljzp5E3d.js";import{L as k}from"./label-DkcLJd5U.js";import{T as ae}from"./textarea-CyBfWePp.js";import{S as L,a as B,b as M,c as O,d as w}from"./select-kcfAJY73.js";import{C as oe,b as ne,c as ce,d as ie,a as le}from"./card-DZzBpZMV.js";import{u as de}from"./index-n9-Tr9Se.js";import{C as me}from"./Combination-CjoguCJq.js";import{S as ue}from"./stethoscope-B07MkWAq.js";import{C as he}from"./chevron-down-CDPvgecV.js";import{S as xe}from"./search-Cwc4OOby.js";import{L as T,T as q}from"./triangle-alert-DPzBkwEj.js";import{N as pe,U as fe,F as ge}from"./Footer-Dg67bZa1.js";import{C as je}from"./clock-Dha9eYj5.js";import{F as be}from"./file-text-DXNCTGNo.js";import"./index-BdQq_4o_.js";import"./index-BuAs8_WM.js";var _="Checkbox",[ve,Ue]=W(_),[Ne,A]=ve(_);function ye(n){const{__scopeCheckbox:l,checked:u,children:i,defaultChecked:m,disabled:a,form:j,name:p,onCheckedChange:h,required:f,value:d="on",internal_do_not_use_render:g}=n,[b,v]=ee({prop:u,defaultProp:m??!1,onChange:h,caller:_}),[x,N]=r.useState(null),[o,t]=r.useState(null),c=r.useRef(!1),C=x?!!j||!!x.closest("form"):!0,y={checked:b,disabled:a,setChecked:v,control:x,setControl:N,name:p,form:j,value:d,hasConsumerStoppedPropagationRef:c,required:f,defaultChecked:P(m)?!1:m,isFormControl:C,bubbleInput:o,setBubbleInput:t};return e.jsx(Ne,{scope:l,...y,children:Ce(g)?g(y):i})}var U="CheckboxTrigger",V=r.forwardRef(({__scopeCheckbox:n,onKeyDown:l,onClick:u,...i},m)=>{const{control:a,value:j,disabled:p,checked:h,required:f,setControl:d,setChecked:g,hasConsumerStoppedPropagationRef:b,isFormControl:v,bubbleInput:x}=A(U,n),N=z(m,d),o=r.useRef(h);return r.useEffect(()=>{const t=a==null?void 0:a.form;if(t){const c=()=>g(o.current);return t.addEventListener("reset",c),()=>t.removeEventListener("reset",c)}},[a,g]),e.jsx(I.button,{type:"button",role:"checkbox","aria-checked":P(h)?"mixed":h,"aria-required":f,"data-state":K(h),"data-disabled":p?"":void 0,disabled:p,value:j,...i,ref:N,onKeyDown:F(l,t=>{t.key==="Enter"&&t.preventDefault()}),onClick:F(u,t=>{g(c=>P(c)?!0:!c),x&&v&&(b.current=t.isPropagationStopped(),b.current||t.stopPropagation())})})});V.displayName=U;var R=r.forwardRef((n,l)=>{const{__scopeCheckbox:u,name:i,checked:m,defaultChecked:a,required:j,disabled:p,value:h,onCheckedChange:f,form:d,...g}=n;return e.jsx(ye,{__scopeCheckbox:u,checked:m,defaultChecked:a,disabled:p,required:j,onCheckedChange:f,name:i,form:d,value:h,internal_do_not_use_render:({isFormControl:b})=>e.jsxs(e.Fragment,{children:[e.jsx(V,{...g,ref:l,__scopeCheckbox:u}),b&&e.jsx(X,{__scopeCheckbox:u})]})})});R.displayName=_;var $="CheckboxIndicator",H=r.forwardRef((n,l)=>{const{__scopeCheckbox:u,forceMount:i,...m}=n,a=A($,u);return e.jsx(Q,{present:i||P(a.checked)||a.checked===!0,children:e.jsx(I.span,{"data-state":K(a.checked),"data-disabled":a.disabled?"":void 0,...m,ref:l,style:{pointerEvents:"none",...n.style}})})});H.displayName=$;var G="CheckboxBubbleInput",X=r.forwardRef(({__scopeCheckbox:n,...l},u)=>{const{control:i,hasConsumerStoppedPropagationRef:m,checked:a,defaultChecked:j,required:p,disabled:h,name:f,value:d,form:g,bubbleInput:b,setBubbleInput:v}=A(G,n),x=z(u,v),N=de(a),o=Z(i);r.useEffect(()=>{const c=b;if(!c)return;const C=window.HTMLInputElement.prototype,s=Object.getOwnPropertyDescriptor(C,"checked").set,S=!m.current;if(N!==a&&s){const J=new Event("click",{bubbles:S});c.indeterminate=P(a),s.call(c,P(a)?!1:a),c.dispatchEvent(J)}},[b,N,a,m]);const t=r.useRef(P(a)?!1:a);return e.jsx(I.input,{type:"checkbox","aria-hidden":!0,defaultChecked:j??t.current,required:p,disabled:h,name:f,value:d,form:g,...l,tabIndex:-1,ref:x,style:{...l.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});X.displayName=G;function Ce(n){return typeof n=="function"}function P(n){return n==="indeterminate"}function K(n){return P(n)?"indeterminate":n?"checked":"unchecked"}const Y=r.forwardRef(({className:n,...l},u)=>e.jsx(R,{ref:u,className:D("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),...l,children:e.jsx(H,{className:D("flex items-center justify-center text-current"),children:e.jsx(me,{className:"h-4 w-4"})})}));Y.displayName=R.displayName;const ke=({value:n,onValueChange:l,placeholder:u="Select a doctor"})=>{const[i,m]=r.useState([]),[a,j]=r.useState([]),[p,h]=r.useState(!1),[f,d]=r.useState(!1),[g,b]=r.useState(null),[v,x]=r.useState(""),N=r.useRef(null),o=r.useRef(null),t=i.find(s=>s.doctor_id===n);r.useEffect(()=>{c()},[]),r.useEffect(()=>{const s=i.filter(S=>S.name.toLowerCase().includes(v.toLowerCase())||S.specialization.toLowerCase().includes(v.toLowerCase()));j(s)},[i,v]),r.useEffect(()=>{const s=S=>{N.current&&!N.current.contains(S.target)&&(h(!1),x(""))};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const c=async()=>{d(!0),b(null);try{const s=await fetch("/api/doctors");if(!s.ok)throw new Error("Failed to fetch doctors");const S=await s.json();m(S),j(S)}catch(s){b(s instanceof Error?s.message:"Failed to load doctors")}finally{d(!1)}},C=()=>{h(!p),p||setTimeout(()=>{var s;return(s=o.current)==null?void 0:s.focus()},100)},y=s=>{l(s.doctor_id),h(!1),x("")};return e.jsxs("div",{className:"relative",ref:N,children:[e.jsxs("button",{type:"button",onClick:C,className:"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","aria-expanded":p?"true":"false","aria-haspopup":"listbox","aria-label":"Select doctor",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4 text-muted-foreground"}),t?e.jsxs("span",{className:"truncate",children:[t.name," - ",t.specialization]}):e.jsx("span",{className:"text-muted-foreground",children:u})]}),e.jsx(he,{className:`h-4 w-4 transition-transform ${p?"rotate-180":""}`})]}),p&&e.jsxs("div",{className:"absolute z-50 mt-1 w-full rounded-md border bg-popover p-0 shadow-md animate-in fade-in-0 zoom-in-95",children:[e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx("input",{ref:o,type:"text",placeholder:"Search doctors...",value:v,onChange:s=>x(s.target.value),className:"h-9 w-full rounded-md border border-input bg-background pl-8 pr-3 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Search doctors"})]})}),e.jsx("div",{className:"max-h-60 overflow-auto",children:f?e.jsxs("div",{className:"flex items-center justify-center py-6",children:[e.jsx(T,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Loading doctors..."})]}):g?e.jsxs("div",{className:"px-3 py-6 text-center",children:[e.jsx("p",{className:"text-sm text-destructive",children:g}),e.jsx("button",{onClick:c,className:"mt-2 text-sm text-primary hover:underline",children:"Try again"})]}):a.length===0?e.jsx("div",{className:"px-3 py-6 text-center text-sm text-muted-foreground",children:v?"No doctors found matching your search.":"No doctors available."}):e.jsx("div",{role:"listbox","aria-label":"Doctor options",children:a.map(s=>e.jsx("button",{type:"button",onClick:()=>y(s),className:`w-full px-3 py-2 text-left text-sm hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none ${n===s.doctor_id?"bg-accent text-accent-foreground":""}`,role:"option","aria-selected":n===s.doctor_id?"true":"false",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[s.specialization," • $",s.consultation_fee]})]})},s.doctor_id))})})]})]})},Ve=()=>{const n=te(),[l,u]=r.useState({name:"",email:"",phone:"",gender:""}),[i,m]=r.useState({date:"",time:"",doctor_id:void 0,consultationType:"",reason:"",termsAccepted:!1}),[a,j]=r.useState(!1),[p,h]=r.useState(!0),[f,d]=r.useState({}),[g,b]=r.useState(""),v=async o=>{o.preventDefault(),j(!0),d({}),b("");const t={};if(i.date||(t.date=["Date is required"]),i.time||(t.time=["Time is required"]),i.doctor_id||(t.doctor_id=["Please select a doctor"]),i.termsAccepted||(t.termsAccepted=["You must accept the terms"]),Object.keys(t).length>0){d(t),j(!1);return}try{const c=localStorage.getItem("token"),C=await fetch("/api/appointments",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",Accept:"application/json",Authorization:c?`Bearer ${c}`:""},body:JSON.stringify(i)}),y=await C.json();C.ok&&y.success?(b(y.message),m({date:"",time:"",doctor_id:void 0,consultationType:"",reason:"",termsAccepted:!1}),setTimeout(()=>{n("/patient-dashboard")},2e3)):y.errors?d(y.errors):d({general:[y.message||"Failed to book appointment. Please try again."]})}catch(c){console.error("Appointment booking error:",c),d({general:["Network error. Please check your connection and try again."]})}finally{j(!1)}},x=(o,t)=>{m(c=>({...c,[o]:t}))},N=o=>{m(t=>({...t,doctor_id:o}))};return r.useEffect(()=>{(async()=>{try{const t=localStorage.getItem("token");if(!t){d({general:["Please log in to book an appointment"]}),h(!1);return}const c=await fetch("/api/patient/profile",{headers:{Authorization:`Bearer ${t}`,Accept:"application/json"}});if(c.ok){const C=await c.json();u(C)}else d({general:["Unable to load patient profile. Please log in again."]})}catch{d({general:["Network error. Please check your connection."]})}finally{h(!1)}})()},[]),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(pe,{}),e.jsx("div",{className:"pt-20",children:e.jsx("div",{className:"container mx-auto px-4 py-16",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-display font-bold text-gradient mb-6",children:"Book Your Appointment"}),e.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"Schedule your consultation with Dr. Sarah Mitchell and take the first step towards better health"})]}),e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs(oe,{className:"shadow-card border-border bg-card",children:[e.jsxs(ne,{children:[e.jsxs(ce,{className:"flex items-center gap-2 text-foreground",children:[e.jsx(se,{className:"h-5 w-5 text-primary"}),"Appointment Details"]}),e.jsx(ie,{className:"text-muted-foreground",children:"Fill in your information to schedule an appointment"})]}),e.jsx(le,{children:e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[g&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-5 w-5 text-green-600",children:"✓"}),e.jsx("p",{className:"text-green-800 font-medium",children:g})]})}),f.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(q,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Booking Failed"}),f.general.map((o,t)=>e.jsx("p",{className:"text-sm text-red-700",children:o},t))]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Patient Information"]}),p?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(T,{className:"h-4 w-4 animate-spin"}),"Loading patient details..."]}):e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-sm text-gray-600",children:"Full Name"}),e.jsx(E,{value:l.name,readOnly:!0,className:"bg-gray-100 cursor-not-allowed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-sm text-gray-600",children:"Email"}),e.jsx(E,{value:l.email,readOnly:!0,className:"bg-gray-100 cursor-not-allowed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-sm text-gray-600",children:"Phone"}),e.jsx(E,{value:l.phone,readOnly:!0,className:"bg-gray-100 cursor-not-allowed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-sm text-gray-600",children:"Gender"}),e.jsx(E,{value:l.gender?l.gender.charAt(0).toUpperCase()+l.gender.slice(1):"",readOnly:!0,className:"bg-gray-100 cursor-not-allowed"})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"date",children:"Preferred Date"}),e.jsx(E,{id:"date",type:"date",value:i.date,onChange:o=>x("date",o.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"time",className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Preferred Time"]}),e.jsxs(L,{onValueChange:o=>x("time",o),children:[e.jsx(B,{children:e.jsx(M,{placeholder:"Select time"})}),e.jsxs(O,{children:[e.jsx(w,{value:"09:00",children:"9:00 AM"}),e.jsx(w,{value:"10:00",children:"10:00 AM"}),e.jsx(w,{value:"11:00",children:"11:00 AM"}),e.jsx(w,{value:"14:00",children:"2:00 PM"}),e.jsx(w,{value:"15:00",children:"3:00 PM"}),e.jsx(w,{value:"16:00",children:"4:00 PM"})]})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"doctor",children:"Select Doctor"}),e.jsx(ke,{value:i.doctor_id,onValueChange:N,placeholder:"Choose a doctor"}),f.doctor_id&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:f.doctor_id[0]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"consultationType",children:"Consultation Type"}),e.jsxs(L,{onValueChange:o=>x("consultationType",o),children:[e.jsx(B,{children:e.jsx(M,{placeholder:"Select consultation type"})}),e.jsxs(O,{children:[e.jsx(w,{value:"in-person",children:"In-Person Visit"}),e.jsx(w,{value:"telemedicine",children:"Telemedicine"}),e.jsx(w,{value:"follow-up",children:"Follow-up"}),e.jsx(w,{value:"consultation",children:"General Consultation"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"reason",className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Reason for Visit"]}),e.jsx(ae,{id:"reason",value:i.reason,onChange:o=>x("reason",o.target.value),placeholder:"Please describe your symptoms or reason for the appointment",rows:4})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(q,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-800 mb-1",children:"Emergency Notice"}),e.jsx("p",{className:"text-sm text-red-700",children:"If you are experiencing a medical emergency, please call 911 immediately or visit your nearest emergency room. This appointment booking system is not for urgent medical situations."})]})]})}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Y,{id:"terms",checked:i.termsAccepted,onCheckedChange:o=>x("termsAccepted",o),required:!0}),e.jsxs(k,{htmlFor:"terms",className:"text-sm leading-relaxed",children:["I agree to the"," ",e.jsx("a",{href:"#",className:"text-primary hover:underline",children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:"#",className:"text-primary hover:underline",children:"Privacy Policy"}),". I understand that appointment confirmation is subject to availability and will be confirmed via email or phone."]})]}),e.jsx(re,{type:"submit",className:"w-full gradient-primary shadow-elegant hover:shadow-glow",disabled:!i.termsAccepted||a,children:a?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Booking Appointment..."]}):"Book Appointment"}),f.termsAccepted&&e.jsx("p",{className:"text-sm text-red-600 text-center",children:f.termsAccepted[0]})]})})]})})]})})}),e.jsx(ge,{})]})};export{Ve as default};
