import{a as E,r as i,j as e,B as o}from"./app-BmRBHgJ5.js";import{H as T}from"./Helmet-Bygm_3Oh.js";import{D as F}from"./DoctorSidebar-OX84QvNe.js";import{N as z,F as P}from"./Footer-CRBcJOEq.js";import{C as _,b as I,c as $,d as L}from"./card-_A9515Kj.js";import{I as m}from"./input-CAmH7sVm.js";import{T as y}from"./textarea-DkhDEAVD.js";import{L as n}from"./label-B0Yc5DFV.js";import{D as q,b as O,a as A,c as H,d as U}from"./dialog-Di6EPEjD.js";import{P as R}from"./plus-DCDx7dDI.js";import{E as M}from"./eye-BB72wviu.js";import{S as J}from"./square-pen-Dmp9k5Q9.js";import{T as G}from"./trash-2-CysamgfE.js";import"./users-wUiyxhG_.js";import"./clock-CC_Y97Y9.js";import"./stethoscope-DtGexrCB.js";import"./file-text-BBhvyIwt.js";import"./message-square-0YtAmhJR.js";import"./pill-VihdKcWb.js";import"./index-V3zJPndz.js";import"./Combination-Dnx0U-nf.js";const pe=()=>{const N=E(),[C,b]=i.useState([]),[p,u]=i.useState(!1),[j,l]=i.useState(""),[D,x]=i.useState(!1),[c,h]=i.useState(null),[s,r]=i.useState({title:"",excerpt:"",content:"",category:"",image:"",read_time:"",status:"published"});i.useEffect(()=>{g()},[]);const g=async()=>{try{const t=localStorage.getItem("token"),a=await fetch("/api/doctor-blogs",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(a.ok){const d=await a.json();b(d)}}catch(t){console.error("Error fetching blogs:",t)}},w=async t=>{t.preventDefault(),l(""),u(!0);try{const a=localStorage.getItem("token"),d=c?`/api/blogs/${c.id}`:"/api/blogs",v=await fetch(d,{method:c?"PUT":"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(v.ok)await g(),f();else{const B=await v.json().catch(()=>({message:"Unknown error occurred"}));l(B.message||"Failed to save blog")}}catch(a){l("Network error: "+a.message)}finally{u(!1)}},f=()=>{r({title:"",excerpt:"",content:"",category:"",image:"",read_time:"",status:"published"}),h(null),x(!1),l("")},S=t=>{h(t),r({title:t.title,excerpt:t.excerpt,content:t.content,category:t.category,image:t.image,read_time:t.read_time,status:t.status}),x(!0),l("")},k=async t=>{if(confirm("Are you sure you want to delete this blog?"))try{const a=localStorage.getItem("token");(await fetch(`/api/blogs/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok&&g()}catch(a){console.error("Error deleting blog:",a)}};return e.jsxs(e.Fragment,{children:[e.jsx(T,{children:e.jsx("title",{children:"Blog Management - Doctor Dashboard"})}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(z,{}),e.jsxs("div",{className:"flex pt-20",children:[e.jsx(F,{}),e.jsx("main",{className:"flex-1 px-6 py-8",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"mb-8 animate-fade-in-up",children:[e.jsx("h1",{className:"text-4xl font-display font-bold text-gradient mb-4",children:"Blog Management"}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"Create and manage your blog posts"})]}),e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("div",{}),e.jsxs(q,{open:D,onOpenChange:x,children:[e.jsx(O,{asChild:!0,children:e.jsxs(o,{onClick:()=>h(null),className:"gradient-primary",children:[e.jsx(R,{size:20,className:"mr-2"}),"New Blog Post"]})}),e.jsxs(A,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(H,{children:e.jsx(U,{children:c?"Edit Blog Post":"Create New Blog Post"})}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[j&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:j}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"title",children:"Title"}),e.jsx(m,{id:"title",value:s.title,onChange:t=>r({...s,title:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"category",children:"Category"}),e.jsx(m,{id:"category",value:s.category,onChange:t=>r({...s,category:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"excerpt",children:"Excerpt"}),e.jsx(y,{id:"excerpt",value:s.excerpt,onChange:t=>r({...s,excerpt:t.target.value}),rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"content",children:"Content"}),e.jsx(y,{id:"content",value:s.content,onChange:t=>r({...s,content:t.target.value}),rows:8,required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"image",children:"Image URL"}),e.jsx(m,{id:"image",value:s.image,onChange:t=>r({...s,image:t.target.value}),placeholder:"/src/assets/blog-image.jpg"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"read_time",children:"Reading Time"}),e.jsx(m,{id:"read_time",value:s.read_time,onChange:t=>r({...s,read_time:t.target.value}),placeholder:"5 min read"})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(o,{type:"submit",className:"gradient-primary",disabled:p,children:[p?"Saving...":c?"Update":"Create"," Blog Post"]}),e.jsx(o,{type:"button",variant:"outline",onClick:f,children:"Cancel"})]})]})]})]})]}),e.jsx("div",{className:"grid gap-6",children:C.map(t=>e.jsx(_,{className:"border-2 border-border",children:e.jsx(I,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx($,{className:"text-xl font-display",children:t.title}),e.jsx(L,{className:"mt-2",children:t.excerpt}),e.jsxs("div",{className:"flex gap-4 mt-3 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Category: ",t.category]}),e.jsxs("span",{children:["Date: ",new Date(t.created_at).toLocaleDateString()]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:()=>N(`/blog/${t.id}`),children:e.jsx(M,{size:16})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>S(t),children:e.jsx(J,{size:16})}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>k(t.id),children:e.jsx(G,{size:16})})]})]})})},t.id))})]})})]}),e.jsx(P,{})]})]})};export{pe as default};
