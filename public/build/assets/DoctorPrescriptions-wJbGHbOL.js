import{c as Q,r,j as e,B as o,X as Y}from"./app-YdvJHR_T.js";import{H as Z}from"./Helmet-ByfTKO2-.js";import{C as ee,b as te,c as se,d as ae,a as re}from"./card-0KLeCNnw.js";import{I as f}from"./input--naLFATU.js";import{L as m}from"./label-hsmbQXF9.js";import{T as ie}from"./textarea-Lz8u0a6U.js";import{S,a as _,b as w,c as C,d as i}from"./select-B85KIasS.js";import{N as ne,C as le,F as ce}from"./Footer-BC-QluM6.js";import{D as oe,C as de}from"./DoctorSidebar-C1LanZ8A.js";import{P as me}from"./plus-DewL3AO0.js";import{S as ue}from"./search-Dl8CO9Gp.js";import{P as he}from"./pill-DMSR3dLh.js";import{S as xe}from"./square-pen-DhiLk-hx.js";import{T as pe}from"./trash-2-Fi7nDfKa.js";import{C as je}from"./chevron-left-zPdoSbJh.js";import"./index-BdQq_4o_.js";import"./index-4x0INjH8.js";import"./Combination-BwU9F5sP.js";import"./index-CID4T0iK.js";import"./chevron-down-CK_HhO2a.js";import"./users-BHPexbR8.js";import"./clock-BRGplpb2.js";import"./stethoscope-jFTurxCp.js";import"./file-text-Cnr46nTf.js";import"./message-square-dMPkuzBv.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=Q("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Ue=()=>{const[q,O]=r.useState([]),[E,R]=r.useState([]),[V,P]=r.useState(!1),[p,I]=r.useState(null),[y,N]=r.useState(!1),[$,n]=r.useState(""),[z,h]=r.useState(""),[v,U]=r.useState(""),[b,H]=r.useState("all"),[u,k]=r.useState(1),[T,M]=r.useState(1),[x,D]=r.useState([]),[s,l]=r.useState({patient_id:"",medication_name:"",dosage:"",frequency:"",instructions:"",start_date:"",end_date:"",is_active:!0,refills_remaining:""});r.useEffect(()=>{j(),J()},[]),r.useEffect(()=>{const t=setTimeout(()=>{v!==void 0&&K()},500);return()=>clearTimeout(t)},[v,b]);const j=async(t=1)=>{try{N(!0);const a=localStorage.getItem("token"),d=new URLSearchParams({page:t.toString(),per_page:"10",...v&&{search:v},...b!=="all"&&{status:b}}),g=await fetch(`/api/prescriptions?${d}`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(g.ok){const c=await g.json();O(c.data||c),k(c.current_page||1),M(c.last_page||1)}}catch(a){console.error("Error fetching prescriptions:",a),n("Failed to fetch prescriptions")}finally{N(!1)}},J=async()=>{try{const t=localStorage.getItem("token"),a=await fetch("/api/patients",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(a.ok){const d=await a.json();R(d)}}catch(t){console.error("Error fetching patients:",t)}},W=async t=>{if(t.preventDefault(),n(""),!s.patient_id||!s.medication_name||!s.dosage||!s.frequency||!s.start_date){n("Please fill in all required fields");return}N(!0);try{const a=localStorage.getItem("token"),d=p?`/api/prescriptions/${p}`:"/api/prescriptions",c=await fetch(d,{method:p?"PUT":"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(c.ok)await j(u),L(),h(p?"Prescription updated successfully!":"Prescription added successfully!"),setTimeout(()=>h(""),3e3);else{const A=await c.json().catch(()=>({message:"Unknown error occurred"}));n(A.message||"Failed to save prescription")}}catch(a){n("Network error: "+a.message)}finally{N(!1)}},L=()=>{l({patient_id:"",medication_name:"",dosage:"",frequency:"",instructions:"",start_date:"",end_date:"",is_active:!0,refills_remaining:""}),P(!1),I(null),n(""),h("")},X=t=>{l({patient_id:t.patient_id.toString(),medication_name:t.medication_name,dosage:t.dosage,frequency:t.frequency,instructions:t.instructions||"",start_date:t.start_date,end_date:t.end_date||"",is_active:t.is_active,refills_remaining:t.refills_remaining||""}),I(t.id),P(!0)},G=async t=>{if(confirm("Are you sure you want to delete this prescription?"))try{const a=localStorage.getItem("token");(await fetch(`/api/prescriptions/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok?(await j(u),h("Prescription deleted successfully!"),setTimeout(()=>h(""),3e3)):n("Failed to delete prescription")}catch(a){n("Network error: "+a.message)}},F=async t=>{if(x.length===0){n("Please select prescriptions first");return}if(confirm(`Are you sure you want to ${t} selected prescriptions?`))try{const a=localStorage.getItem("token");(await fetch("/api/prescriptions/bulk-update",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({prescription_ids:x,action:t})})).ok?(await j(u),D([]),h(`Prescriptions ${t}d successfully!`),setTimeout(()=>h(""),3e3)):n(`Failed to ${t} prescriptions`)}catch(a){n("Network error: "+a.message)}},K=()=>{k(1),j(1)},B=t=>{k(t),j(t)};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{children:e.jsx("title",{children:"Prescriptions - Doctor Dashboard"})}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(ne,{}),e.jsxs("div",{className:"flex pt-20",children:[e.jsx(oe,{}),e.jsx("main",{className:"flex-1 px-6 py-8",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"mb-8 animate-fade-in-up",children:[e.jsx("h1",{className:"text-4xl font-display font-bold text-gradient mb-4",children:"Prescriptions"}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"Manage patient prescriptions and medications"})]}),e.jsxs(ee,{className:"shadow-card border-border bg-card",children:[e.jsxs(te,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5 text-primary"}),"Prescriptions Management"]}),e.jsx(ae,{children:"View and manage patient medications"})]}),e.jsxs(o,{onClick:()=>P(!0),className:"gradient-primary shadow-elegant",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Add Prescription"]})]}),e.jsxs(re,{children:[e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(f,{placeholder:"Search by medication or patient name...",value:v,onChange:t=>U(t.target.value),className:"pl-10"})]}),e.jsxs(S,{value:b,onValueChange:H,children:[e.jsxs(_,{className:"w-full sm:w-48",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),e.jsx(w,{})]}),e.jsxs(C,{children:[e.jsx(i,{value:"all",children:"All Status"}),e.jsx(i,{value:"active",children:"Active Only"}),e.jsx(i,{value:"inactive",children:"Inactive Only"})]})]})]}),x.length>0&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-blue-700",children:[x.length," prescription(s) selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{size:"sm",variant:"outline",onClick:()=>F("activate"),children:"Activate"}),e.jsx(o,{size:"sm",variant:"outline",onClick:()=>F("deactivate"),children:"Deactivate"}),e.jsx(o,{size:"sm",variant:"destructive",onClick:()=>F("delete"),children:"Delete"})]})]}),V&&e.jsxs("form",{onSubmit:W,className:"mb-6 p-4 border border-border rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:p?"Edit Prescription":"New Prescription"}),e.jsx(o,{type:"button",onClick:L,variant:"ghost",size:"sm",children:e.jsx(Y,{className:"h-4 w-4"})})]}),$&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:$}),z&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md text-green-700 text-sm",children:z}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Patient *"}),e.jsxs(S,{value:s.patient_id,onValueChange:t=>l({...s,patient_id:t}),children:[e.jsx(_,{children:e.jsx(w,{placeholder:"Select patient"})}),e.jsx(C,{children:E.map(t=>e.jsx(i,{value:t.patient_id.toString(),children:t.name},t.patient_id))})]})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Medication Name *"}),e.jsx(f,{value:s.medication_name,onChange:t=>l({...s,medication_name:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Dosage *"}),e.jsx(f,{value:s.dosage,onChange:t=>l({...s,dosage:t.target.value}),placeholder:"e.g., 100mg",required:!0})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Frequency *"}),e.jsxs(S,{value:s.frequency,onValueChange:t=>l({...s,frequency:t}),children:[e.jsx(_,{children:e.jsx(w,{placeholder:"Select frequency"})}),e.jsxs(C,{children:[e.jsx(i,{value:"Once daily",children:"Once daily"}),e.jsx(i,{value:"Twice daily",children:"Twice daily"}),e.jsx(i,{value:"Three times daily",children:"Three times daily"}),e.jsx(i,{value:"Four times daily",children:"Four times daily"}),e.jsx(i,{value:"As needed",children:"As needed"}),e.jsx(i,{value:"Weekly",children:"Weekly"})]})]})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Start Date *"}),e.jsx(f,{type:"date",value:s.start_date,onChange:t=>l({...s,start_date:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(m,{children:"End Date"}),e.jsx(f,{type:"date",value:s.end_date,onChange:t=>l({...s,end_date:t.target.value}),min:s.start_date})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Refills Remaining"}),e.jsx(f,{type:"number",min:"0",value:s.refills_remaining,onChange:t=>l({...s,refills_remaining:t.target.value}),placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Status"}),e.jsxs(S,{value:s.is_active.toString(),onValueChange:t=>l({...s,is_active:t==="true"}),children:[e.jsx(_,{children:e.jsx(w,{})}),e.jsxs(C,{children:[e.jsx(i,{value:"true",children:"Active"}),e.jsx(i,{value:"false",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(m,{children:"Instructions"}),e.jsx(ie,{value:s.instructions,onChange:t=>l({...s,instructions:t.target.value}),placeholder:"Special instructions for the patient"})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(o,{type:"submit",className:"w-full",disabled:y,children:y?"Saving...":p?"Update Prescription":"Add Prescription"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[y?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading prescriptions..."}):q.map(t=>{const a=E.find(c=>c.patient_id===t.patient_id),d=new Date(t.start_date).toLocaleDateString(),g=t.end_date?new Date(t.end_date).toLocaleDateString():null;return e.jsxs("div",{className:"flex justify-between items-start p-4 border border-border rounded-lg bg-muted/50 hover:bg-muted transition-smooth",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:x.includes(t.id),onChange:c=>{c.target.checked?D([...x,t.id]):D(x.filter(A=>A!==t.id))},className:"mr-2"}),e.jsx(he,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:a?a.name:`Patient ID: ${t.patient_id}`}),e.jsx("p",{className:"text-sm text-primary font-medium",children:t.medication_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Dosage: ",t.dosage," | Frequency: ",t.frequency]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Start: ",d,g?` | End: ${g}`:""]}),t.refills_remaining&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Refills: ",t.refills_remaining]}),t.instructions&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1 italic",children:t.instructions}),e.jsx("p",{className:`text-xs mt-1 ${t.is_active?"text-green-600":"text-red-600"}`,children:t.is_active?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{size:"sm",variant:"outline",onClick:()=>X(t),children:e.jsx(xe,{className:"h-4 w-4"})}),e.jsx(o,{size:"sm",variant:"destructive",onClick:()=>G(t.id),children:e.jsx(pe,{className:"h-4 w-4"})})]})]},t.id)}),!y&&q.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No prescriptions found."})]}),T>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",u," of ",T]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{size:"sm",variant:"outline",onClick:()=>B(u-1),disabled:u===1,children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx(o,{size:"sm",variant:"outline",onClick:()=>B(u+1),disabled:u===T,children:e.jsx(le,{className:"h-4 w-4"})})]})]})]})]})]})})]}),e.jsx(ce,{})]})]})};export{Ue as default};
