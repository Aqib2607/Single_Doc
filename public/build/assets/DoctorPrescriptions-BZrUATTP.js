import{r as n,j as e,B as m,X as $}from"./app-CA97xQT9.js";import{H as z}from"./Helmet-VFA4f7Dq.js";import{C as L,b as B,c as O,d as V,a as H}from"./card-gaL2e-uj.js";import{I as h}from"./input-B3Ct7k3H.js";import{L as o}from"./label-D6qvg7bS.js";import{T as U}from"./textarea-C_r1I8D2.js";import{S as w,a as S,b as P,c as C,d}from"./select-DRVG8Pjv.js";import{N as M,F as W}from"./Footer-rh8Alvxn.js";import{D as J,C as R}from"./DoctorSidebar-CdQqX0aC.js";import{P as X}from"./plus-D6IRAj0N.js";import{P as G}from"./pill-DXTK-vPZ.js";import{S as K}from"./square-pen-CUmur6HV.js";import{T as Q}from"./trash-2-Y0-pyl7E.js";import"./index-BdQq_4o_.js";import"./index-BgJJ74YJ.js";import"./Combination-DVZWF5pO.js";import"./index-DTSB0etq.js";import"./chevron-down-BhQJAaf2.js";import"./users-BRuT6zH1.js";import"./clock-BMvmk19V.js";import"./stethoscope-o9s58rJw.js";import"./file-text-BjTYvuFp.js";import"./message-square-BGDqvfeV.js";const Ne=()=>{const[f,D]=n.useState([]),[g,k]=n.useState([]),[q,u]=n.useState(!1),[c,v]=n.useState(null),[y,N]=n.useState(!1),[b,l]=n.useState(""),[s,r]=n.useState({patient_id:"",medication_name:"",dosage:"",frequency:"",instructions:"",start_date:"",end_date:"",is_active:!0});n.useEffect(()=>{p(),E()},[]);const p=async()=>{try{const t=localStorage.getItem("token"),a=await fetch("/api/prescriptions",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(a.ok){const i=await a.json();D(i)}}catch(t){console.error("Error fetching prescriptions:",t)}},E=async()=>{try{const t=localStorage.getItem("token"),a=await fetch("/api/patients",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(a.ok){const i=await a.json();k(i)}}catch(t){console.error("Error fetching patients:",t)}},T=async t=>{if(t.preventDefault(),l(""),!s.patient_id||!s.medication_name||!s.dosage||!s.frequency||!s.start_date){l("Please fill in all required fields");return}N(!0);try{const a=localStorage.getItem("token"),i=c?`/api/prescriptions/${c.id}`:"/api/prescriptions",x=await fetch(i,{method:c?"PUT":"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(x.ok)await p(),_(),alert(c?"Prescription updated successfully!":"Prescription added successfully!");else{const I=await x.json().catch(()=>({message:"Unknown error occurred"}));l(I.message||"Failed to save prescription")}}catch(a){l("Network error: "+a.message)}finally{N(!1)}},F=t=>{var a;v(t),r({patient_id:((a=t.patient_id)==null?void 0:a.toString())||"",medication_name:t.medication_name||"",dosage:t.dosage||"",frequency:t.frequency||"",instructions:t.instructions||"",start_date:t.start_date||"",end_date:t.end_date||"",is_active:t.is_active??!0}),u(!0),l("")},A=async t=>{if(confirm("Are you sure you want to delete this prescription?"))try{const a=localStorage.getItem("token");(await fetch(`/api/prescriptions/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok&&(p(),alert("Prescription deleted successfully!"))}catch(a){console.error("Error deleting prescription:",a)}},_=()=>{r({patient_id:"",medication_name:"",dosage:"",frequency:"",instructions:"",start_date:"",end_date:"",is_active:!0}),v(null),u(!1),l("")};return e.jsxs(e.Fragment,{children:[e.jsx(z,{children:e.jsx("title",{children:"Prescriptions - Doctor Dashboard"})}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(M,{}),e.jsxs("div",{className:"flex pt-20",children:[e.jsx(J,{}),e.jsx("main",{className:"flex-1 px-6 py-8",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"mb-8 animate-fade-in-up",children:[e.jsx("h1",{className:"text-4xl font-display font-bold text-gradient mb-4",children:"Prescriptions"}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"Manage patient prescriptions and medications"})]}),e.jsxs(L,{className:"shadow-card border-border bg-card",children:[e.jsxs(B,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5 text-primary"}),"Active Prescriptions"]}),e.jsx(V,{children:"View and manage patient medications"})]}),e.jsxs(m,{onClick:()=>u(!0),className:"gradient-primary shadow-elegant",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"New Prescription"]})]}),e.jsxs(H,{children:[q&&e.jsxs("form",{onSubmit:T,className:"mb-6 p-4 border border-border rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:c?"Edit Prescription":"New Prescription"}),e.jsx(m,{type:"button",onClick:_,variant:"ghost",size:"sm",children:e.jsx($,{className:"h-4 w-4"})})]}),b&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:b}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Patient *"}),e.jsxs(w,{value:s.patient_id,onValueChange:t=>r({...s,patient_id:t}),children:[e.jsx(S,{children:e.jsx(P,{placeholder:"Select patient"})}),e.jsx(C,{children:g.map(t=>e.jsx(d,{value:t.id.toString(),children:t.name},t.id))})]})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Medication Name *"}),e.jsx(h,{value:s.medication_name,onChange:t=>r({...s,medication_name:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Dosage *"}),e.jsx(h,{value:s.dosage,onChange:t=>r({...s,dosage:t.target.value}),placeholder:"e.g., 100mg",required:!0})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Frequency *"}),e.jsxs(w,{value:s.frequency,onValueChange:t=>r({...s,frequency:t}),children:[e.jsx(S,{children:e.jsx(P,{placeholder:"Select frequency"})}),e.jsxs(C,{children:[e.jsx(d,{value:"Once daily",children:"Once daily"}),e.jsx(d,{value:"Twice daily",children:"Twice daily"}),e.jsx(d,{value:"Three times daily",children:"Three times daily"}),e.jsx(d,{value:"Four times daily",children:"Four times daily"}),e.jsx(d,{value:"As needed",children:"As needed"}),e.jsx(d,{value:"Weekly",children:"Weekly"})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Start Date *"}),e.jsx(h,{type:"date",value:s.start_date,onChange:t=>r({...s,start_date:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(o,{children:"End Date"}),e.jsx(h,{type:"date",value:s.end_date,onChange:t=>r({...s,end_date:t.target.value})})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(o,{children:"Instructions"}),e.jsx(U,{value:s.instructions,onChange:t=>r({...s,instructions:t.target.value}),placeholder:"Special instructions for the patient"})]}),e.jsx("div",{className:"col-span-2",children:e.jsx(m,{type:"submit",className:"w-full",disabled:y,children:y?"Saving...":c?"Update Prescription":"Add Prescription"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[f.map(t=>{const a=g.find(x=>x.id===t.patient_id),i=new Date(t.start_date).toLocaleDateString(),j=t.end_date?new Date(t.end_date).toLocaleDateString():null;return e.jsxs("div",{className:"flex justify-between items-start p-4 border border-border rounded-lg bg-muted/50 hover:bg-muted transition-smooth",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:a?a.name:`Patient ID: ${t.patient_id}`}),e.jsx("p",{className:"text-sm text-primary font-medium",children:t.medication_name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Dosage: ",t.dosage," | Frequency: ",t.frequency]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Start: ",i,j?` | End: ${j}`:""]}),t.instructions&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1 italic",children:t.instructions}),e.jsx("p",{className:`text-xs mt-1 ${t.is_active?"text-green-600":"text-red-600"}`,children:t.is_active?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{onClick:()=>F(t),size:"sm",variant:"outline",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx(m,{onClick:()=>A(t.id),size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",children:e.jsx(Q,{className:"h-4 w-4"})})]})]},t.id)}),f.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'No prescriptions found. Click "New Prescription" to create your first prescription.'})]})]})]})]})})]}),e.jsx(W,{})]})]})};export{Ne as default};
