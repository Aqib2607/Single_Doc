import{r as o,j as e,B as i}from"./app-YdvJHR_T.js";import{H as E}from"./Helmet-ByfTKO2-.js";import{D as T}from"./DoctorSidebar-C1LanZ8A.js";import{N as F,F as _}from"./Footer-BC-QluM6.js";import{C as z,b as I,c as P,d as L}from"./card-0KLeCNnw.js";import{I as m}from"./input--naLFATU.js";import{T as y}from"./textarea-Lz8u0a6U.js";import{L as n}from"./label-hsmbQXF9.js";import{D as $,b as q,a as O,c as A,d as H}from"./dialog-CbgPaiEh.js";import{P as U}from"./plus-DewL3AO0.js";import{E as R}from"./eye-DSPUA6gD.js";import{S as M}from"./square-pen-DhiLk-hx.js";import{T as J}from"./trash-2-Fi7nDfKa.js";import"./users-BHPexbR8.js";import"./clock-BRGplpb2.js";import"./stethoscope-jFTurxCp.js";import"./file-text-Cnr46nTf.js";import"./message-square-dMPkuzBv.js";import"./pill-DMSR3dLh.js";import"./index-4x0INjH8.js";import"./Combination-BwU9F5sP.js";const ge=()=>{const[N,b]=o.useState([]),[p,u]=o.useState(!1),[j,l]=o.useState(""),[C,x]=o.useState(!1),[c,h]=o.useState(null),[s,r]=o.useState({title:"",excerpt:"",content:"",category:"",image:"",read_time:"",status:"published"});o.useEffect(()=>{g()},[]);const g=async()=>{try{const t=localStorage.getItem("token"),a=await fetch("/api/doctor-blogs",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(a.ok){const d=await a.json();b(d)}}catch(t){console.error("Error fetching blogs:",t)}},D=async t=>{t.preventDefault(),l(""),u(!0);try{const a=localStorage.getItem("token"),d=localStorage.getItem("doctor_id")||"1",k=c?`/api/blogs/${c.id}`:"/api/blogs",v=await fetch(k,{method:c?"PUT":"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({...s,doctor_id:d})});if(v.ok)await g(),f();else{const B=await v.json().catch(()=>({message:"Unknown error occurred"}));l(B.message||"Failed to save blog")}}catch(a){l("Network error: "+a.message)}finally{u(!1)}},f=()=>{r({title:"",excerpt:"",content:"",category:"",image:"",read_time:"",status:"published"}),h(null),x(!1),l("")},w=t=>{h(t),r({title:t.title,excerpt:t.excerpt,content:t.content,category:t.category,image:t.image,read_time:t.read_time,status:t.status}),x(!0),l("")},S=async t=>{if(confirm("Are you sure you want to delete this blog?"))try{const a=localStorage.getItem("token");(await fetch(`/api/blogs/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok&&g()}catch(a){console.error("Error deleting blog:",a)}};return e.jsxs(e.Fragment,{children:[e.jsx(E,{children:e.jsx("title",{children:"Blog Management - Doctor Dashboard"})}),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(F,{}),e.jsxs("div",{className:"flex pt-20",children:[e.jsx(T,{}),e.jsx("main",{className:"flex-1 px-6 py-8",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"mb-8 animate-fade-in-up",children:[e.jsx("h1",{className:"text-4xl font-display font-bold text-gradient mb-4",children:"Blog Management"}),e.jsx("p",{className:"text-xl text-muted-foreground",children:"Create and manage your blog posts"})]}),e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("div",{}),e.jsxs($,{open:C,onOpenChange:x,children:[e.jsx(q,{asChild:!0,children:e.jsxs(i,{onClick:()=>h(null),className:"gradient-primary",children:[e.jsx(U,{size:20,className:"mr-2"}),"New Blog Post"]})}),e.jsxs(O,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsx(A,{children:e.jsx(H,{children:c?"Edit Blog Post":"Create New Blog Post"})}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[j&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:j}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"title",children:"Title"}),e.jsx(m,{id:"title",value:s.title,onChange:t=>r({...s,title:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"category",children:"Category"}),e.jsx(m,{id:"category",value:s.category,onChange:t=>r({...s,category:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"excerpt",children:"Excerpt"}),e.jsx(y,{id:"excerpt",value:s.excerpt,onChange:t=>r({...s,excerpt:t.target.value}),rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"content",children:"Content"}),e.jsx(y,{id:"content",value:s.content,onChange:t=>r({...s,content:t.target.value}),rows:8,required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"image",children:"Image URL"}),e.jsx(m,{id:"image",value:s.image,onChange:t=>r({...s,image:t.target.value}),placeholder:"/src/assets/blog-image.jpg"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"read_time",children:"Reading Time"}),e.jsx(m,{id:"read_time",value:s.read_time,onChange:t=>r({...s,read_time:t.target.value}),placeholder:"5 min read"})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(i,{type:"submit",className:"gradient-primary",disabled:p,children:[p?"Saving...":c?"Update":"Create"," Blog Post"]}),e.jsx(i,{type:"button",variant:"outline",onClick:f,children:"Cancel"})]})]})]})]})]}),e.jsx("div",{className:"grid gap-6",children:N.map(t=>e.jsx(z,{className:"border-2 border-border",children:e.jsx(I,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(P,{className:"text-xl font-display",children:t.title}),e.jsx(L,{className:"mt-2",children:t.excerpt}),e.jsxs("div",{className:"flex gap-4 mt-3 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Category: ",t.category]}),e.jsxs("span",{children:["Date: ",new Date(t.created_at).toLocaleDateString()]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:t.status})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",children:e.jsx(R,{size:16})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>w(t),children:e.jsx(M,{size:16})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>S(t.id),children:e.jsx(J,{size:16})})]})]})})},t.id))})]})})]}),e.jsx(_,{})]})]})};export{ge as default};
